> # **English Trainer Bot**

Telegram-–±–æ—Ç –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ —Å–ª–æ–≤–∞—Ä—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

> ## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
>```Py
>.../HW5-7-KursovayW-TelegramBT-LearnEnglish/
>‚îú‚îÄ‚îÄ bot.py # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –±–æ—Ç–∞ (–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥)
>‚îú‚îÄ‚îÄ database.py # –†–∞–±–æ—Ç–∞ —Å PostgreSQL (ORM-—Å–ª–æ–π)
>‚îú‚îÄ‚îÄ learning_test.py # –õ–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
>‚îú‚îÄ‚îÄ translator.py # –ú–æ–¥—É–ª—å –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–ª–æ–≤
>‚îú‚îÄ‚îÄ config.py # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
>‚îú‚îÄ‚îÄ .env # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
>‚îú‚îÄ‚îÄ requirements.txt # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
>‚îî‚îÄ‚îÄ dictionary.xml # XML-—Å–ª–æ–≤–∞—Ä—å –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
>```
___
___
___
> ## –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
___
___
___


>### bot.py

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
bot = Bot(token=os.getenv("BOT_TOKEN"))
dp = Dispatcher()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
```

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞

- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥:

        /start - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

        /history - –∏—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤

        /last_test - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–µ—Å—Ç–∞

- FSM-—Å–æ—Å—Ç–æ—è–Ω–∏—è:

        ADDING_WORD - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤

        REMOVING_WORD - —É–¥–∞–ª–µ–Ω–∏–µ —Å–ª–æ–≤

        TRANSLATING_WORD - —Ä–µ–∂–∏–º –ø–µ—Ä–µ–≤–æ–¥–∞

        TEST - –ø—Ä–æ—Ü–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- –°–∏—Å—Ç–µ–º–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä:

        –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

        Reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è FSM-—Å–æ—Å—Ç–æ—è–Ω–∏–π

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

- –ö–ª—é—á–µ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:
    ``` Text
     start_command - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

     show_word_translation - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞

     process_add_word - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞ –≤ —Å–ª–æ–≤–∞—Ä—å

     start_test_handler - –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞

     test_answer_handler - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ —Ç–µ—Å—Ç–µ
    ```
- –°–æ—Å—Ç–æ—è–Ω–∏—è FSM (Finite State Machine)
```Python

class Form(StatesGroup):
    ADDING_WORD = State()       # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤
    REMOVING_WORD = State()     # –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–æ–≤
    TRANSLATING_WORD = State()  # –ü–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤
    ADDING_TRANSLATION = State()# –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞
    TEST = State()              # –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```
>**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–µ–º `create_words_keyboard()`

    - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å–ª–æ–≤

    - **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

        -    –ü–∞–≥–∏–Ω–∞—Ü–∏—è (6 —Å–ª–æ–≤/—Å—Ç—Ä–∞–Ω–∏—Ü–∞)

        -    –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–ª–æ–≤

        -    –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –¥–µ–π—Å—Ç–≤–∏–π

- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:

    - `start_add_word()`: –ò–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞

    - `process_add_word()`: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥ —Ñ–æ—Ä–º–∞—Ç–∞ "—Å–ª–æ–≤–æ - –ø–µ—Ä–µ–≤–æ–¥"

    - `start_remove_word()`: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

    - `remove_word()`: –£–¥–∞–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ

>**–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞**
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:

    - `start_translate()`: –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º –ø–µ—Ä–µ–≤–æ–¥–∞

    - `translate_input()`: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –ø–µ—Ä–µ–≤–æ–¥–∞

    - `add_translation_handler()`: –î–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–≤–æ–¥ –≤—Ä—É—á–Ω—É—é

> **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞–Ω–∏–π**
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:

    - `start_test_handler()`: –ù–∞—á–∏–Ω–∞–µ—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é —Ç–µ—Å—Ç–∞

    - `test_answer_handler()`: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç—ã

    - `end_test_handler()`: –ó–∞–≤–µ—Ä—à–∞–µ—Ç —Ç–µ—Å—Ç —Å –æ—Ç—á–µ—Ç–æ–º

> **–ò—Å—Ç–æ—Ä–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**
- –§—É–Ω–∫—Ü–∏–∏:

    - `show_test_history()`: –í—ã–≤–æ–¥–∏—Ç –∏—Å—Ç–æ—Ä–∏—é —Ç–µ—Å—Ç–æ–≤

    - `show_last_test_results()`: –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–µ—Å—Ç–∞

    - `show_last_test_details()`: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ —Ç–µ—Å—Ç–∞

>**–ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã**

- –°—Ç–∞—Ä—Ç –±–æ—Ç–∞ (main())

    - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î

    -   –ó–∞–ø—É—Å–∫ polling

- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (start_command())

    -    –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏

    -    –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å–ª–æ–≤–∞–º
>–†–∞–±–æ—Ç–∞ —Å–æ —Å–ª–æ–≤–∞—Ä–µ–º
```mermaid
graph TD
  A[–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ] --> B[–í–≤–æ–¥ —Ñ–æ—Ä–º–∞—Ç–∞]
  B --> C{–í–∞–ª–∏–¥–∞—Ü–∏—è}
  C -->|–£—Å–ø–µ—Ö| D[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ]
  C -->|–û—à–∏–±–∫–∞| E[–ü–æ–≤—Ç–æ—Ä –≤–≤–æ–¥–∞]
```
>–ü—Ä–æ—Ü–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```mermaid
graph LR
  Start --> GenerateQuestion
  GenerateQuestion --> ShowQuestion
  ShowQuestion --> GetAnswer
  GetAnswer --> CheckAnswer
  CheckAnswer --> NextQuestion
  NextQuestion --> EndTest
```

> **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

    -   –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞

    -   –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

    -   –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

    -    –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

    -    –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

    -    –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î

- UX-—Ä–µ—à–µ–Ω–∏—è:

    -    –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

    -    –ß–µ—Ç–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

    -    –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç—á–µ—Ç—ã



___
___
>### database.py
___
___
### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü:
   - users: —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (user_id, username, –∏–º—è, —Ñ–∞–º–∏–ª–∏—è, –¥–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏).
   - default_words: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–∞–±–æ—Ä —Å–ª–æ–≤ (word_id, –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ, —Ä—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥).
   - user_words: —Å–ª–æ–≤–∞, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (user_word_id, user_id, –∞–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ, —Ä—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥, –¥–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è).
   - tests: —Å–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–æ–≤ (test_id, user_id, –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞, –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã).
   - test_results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –≤ —Ç–µ—Å—Ç–µ (id, test_id, —Å–ª–æ–≤–æ, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å, –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞).
   - leaderboard: —Ç–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ (user_id, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤, –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç).


### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL

#### –¢–∞–±–ª–∏—Ü–∞ `users`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `user_id` | BIGINT | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `username` | VARCHAR(255) | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram |
| `first_name` | VARCHAR(255) | –ò–º—è |
| `last_name` | VARCHAR(255) | –§–∞–º–∏–ª–∏—è |
| `registration_date` | TIMESTAMPTZ | –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–ú–°–ö) |

#### –¢–∞–±–ª–∏—Ü–∞ `default_words`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `word_id` | SERIAL | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `english_word` | VARCHAR(255) | –ê–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ (—É–Ω–∏–∫–∞–ª—å–Ω–æ–µ) |
| `russian_translation` | VARCHAR(255) | –†—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ |

#### –¢–∞–±–ª–∏—Ü–∞ `user_words`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `user_word_id` | SERIAL | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `user_id` | BIGINT | –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á (users.user_id) |
| `english_word` | VARCHAR(255) | –ê–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ |
| `russian_translation` | VARCHAR(255) | –†—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ |
| `added_date` | TIMESTAMPTZ | –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (–ú–°–ö) |

#### –¢–∞–±–ª–∏—Ü–∞ `tests`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `test_id` | SERIAL | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `user_id` | BIGINT | –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á (users.user_id) |
| `start_time` | TIMESTAMPTZ | –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∞ |
| `end_time` | TIMESTAMPTZ | –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ |
| `total_questions` | INT | –í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤ |
| `correct_answers` | INT | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã |
| `incorrect_answers` | INT | –û—à–∏–±–∫–∏ |

#### –¢–∞–±–ª–∏—Ü–∞ `test_results`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | SERIAL | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `test_id` | INT | –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á (tests.test_id) |
| `word` | VARCHAR(100) | –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ–µ —Å–ª–æ–≤–æ |
| `correct_answer` | VARCHAR(100) | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç |
| `user_answer` | VARCHAR(100) | –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `is_correct` | BOOLEAN | –§–ª–∞–≥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ |
| `answer_time` | TIMESTAMPTZ | –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ |

#### –¢–∞–±–ª–∏—Ü–∞ `leaderboard`
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `user_id` | BIGINT | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á (users.user_id) |
| `total_tests` | INT | –í—Å–µ–≥–æ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ |
| `total_correct` | INT | –í—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ |
| `total_incorrect` | INT | –í—Å–µ–≥–æ –æ—à–∏–±–æ–∫ |
| `last_test` | TIMESTAMPTZ | –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ç–µ—Å—Ç–∞ |

## –î–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ DBeaver
```mermaid
erDiagram
    users {
        bigint user_id PK
        varchar username
        varchar first_name
        varchar last_name
        timestamptz registration_date
    }
    
    default_words {
        serial word_id PK
        varchar english_word
        varchar russian_translation
    }
    
    user_words {
        serial user_word_id PK
        bigint user_id FK
        varchar english_word
        varchar russian_translation
        timestamptz added_date
    }
    
    tests {
        serial test_id PK
        bigint user_id FK
        timestamptz start_time
        timestamptz end_time
        integer total_questions
        integer correct_answers
        integer incorrect_answers
    }
    
    test_results {
        serial id PK
        integer test_id FK
        varchar word
        varchar correct_answer
        varchar user_answer
        boolean is_correct
        timestamptz answer_time
    }
    
    leaderboard {
        bigint user_id PK,FK
        integer total_tests
        integer total_correct
        integer total_incorrect
        timestamptz last_test
    }

    users ||--o{ user_words : "1:N"
    users ||--o{ tests : "1:N"
    tests ||--o{ test_results : "1:N"
    users ||--|| leaderboard : "1:1"
```

![–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ](https://github.com/VoldemarSoturum/HW5-7-KursovayaDB-TelegramBT-LearnEnglish/blob/main/DbeaverDiagram.PNG "DBEAVER DIAGRAM")

# –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

    add_user() - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    add_user_word() - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞ –≤ —Å–ª–æ–≤–∞—Ä—å

    get_user_words() - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    create_test_session() - —Å—Ç–∞—Ä—Ç –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–∞

    add_test_result() - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤–æ–ø—Ä–æ—Å–∞

    update_leaderboard() - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

>## –ú–æ–¥—É–ª—å learning_test.py


–ú–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ª–æ–≥–∏–∫—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –±–æ—Ç–µ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤.

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### `async def start_learning_test(user_id: int, state: FSMContext)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ç–µ–∫—É—â—É—é

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç–∞ (–Ω–æ–≤—ã–π/–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)
2. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ –ë–î –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
3. –§–æ—Ä–º–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –∏–∑:
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è
   - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Å–ª–æ–≤
   - XML-—Å–ª–æ–≤–∞—Ä—è
4. –í—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —Å–ª–æ–≤–æ –∏ —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–∞ (EN‚ÜíRU –∏–ª–∏ RU‚ÜíEN)
5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ FSM

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

---

### `async def handle_test_response(user_id: int, user_answer: str, correct_answer: str, state: FSMContext)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤–≤–æ–¥ (–ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É, –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ–ø–µ—á–∞—Ç–∫–∏)
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞:
   - –î–ª—è RU‚ÜíEN: —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
   - –î–ª—è EN‚ÜíRU: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–º –ø–µ—Ä–µ–≤–æ–¥–∞–º
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ë–î
4. –§–æ—Ä–º–∏—Ä—É–µ—Ç feedback –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- –§–ª–∞–≥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞
- –¢–µ–∫—Å—Ç —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø—Ä–æ–≤–µ—Ä–∫–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É

---

### `async def end_test_and_show_results(user_id: int, state: FSMContext)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≤–µ—Ä—à–∞–µ—Ç —Ç–µ—Å—Ç –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ç–µ—Å—Ç—É:
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
   - –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
2. –§–æ—Ä–º–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç
3. –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤
4. –û—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç
- –ö–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –æ–ø—Ü–∏—è–º–∏

---

## –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

>### `async def load_words_from_xml()`
–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ª–æ–≤–∞ –∏–∑ XML-—Ñ–∞–π–ª–∞ dictionary.xml

>### `async def _check_answer()`
–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —ç—Ç–∞–ª–æ–Ω–æ–º

>### `async def _get_possible_translations()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–ª–æ–≤–∞

>### `async def _save_test_results()`
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ë–î

>### `def _generate_feedback()`
–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø—Ä–æ–≤–µ—Ä–∫–∏

>### `def _format_results_message()`
–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

>### `async def format_duration()`
–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∞ –≤ —á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç

---

## –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã

```python
ALLOWED_TYPOS = {
    '–ø—Ä—Å—Ç–∏—Ç–µ': '–ø—Ä–æ—Å—Ç–∏—Ç–µ',
    '–∏–∑–≤–Ω–∏—Ç–µ': '–∏–∑–≤–∏–Ω–∏—Ç–µ',
    # ... –∏ –¥—Ä—É–≥–∏–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –æ–ø–µ—á–∞—Ç–∫–∏
}
```

–õ–æ–≥–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤:

    - –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä —Å–ª–æ–≤–∞ (–ª–∏—á–Ω—ã–µ + —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ + XML-—Å–ª–æ–≤–∞—Ä—å)

    - –í–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤–æ–ø—Ä–æ—Å–æ–≤:
        ```
         EN ‚Üí RU ("–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ: apple")

         RU ‚Üí EN ("–ö–∞–∫ –±—É–¥–µ—Ç '—è–±–ª–æ–∫–æ' –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏?")
        ```
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤:

        - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞

        - –£—á–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –æ–ø–µ—á–∞—Ç–æ–∫ (ALLOWED_TYPOS)

        - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞

    - –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏:

        - –ü–æ–¥—Å—á–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

        - –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

        - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

- `start_learning_test()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞

- `handle_test_response()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞

- `end_test_and_show_results()` - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞ –∏ –æ—Ç—á–µ—Ç

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤:

     - –£—á–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –æ–ø–µ—á–∞—Ç–æ–∫

     -  –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–µ—Ä–µ–≤–æ–¥–∞

     -  –†–∞–∑–Ω—ã–µ —Ä–µ–∂–∏–º—ã –≤–æ–ø—Ä–æ—Å–æ–≤

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏:

    -   –†–∞–±–æ—Ç–∞ —Å –ë–î —á–µ—Ä–µ–∑ database.py

    -  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞ –∏–∑ translator.py

    -    –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å FSM

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫:

    -    –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

    -    –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

    -    –ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∞

    -    –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

    -    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤
>___
># –ú–æ–¥—É–ª—å translator.py
>___
## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Å–ª–æ–≤ –º–µ–∂–¥—É –∞–Ω–≥–ª–∏–π—Å–∫–∏–º –∏ —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è XML-—Å–ª–æ–≤–∞—Ä—å.

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

>### `load_dictionary() -> dict`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å –∏–∑ XML-—Ñ–∞–π–ª–∞ –∏ —Å–æ–∑–¥–∞–µ—Ç –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–æ–≤.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ü–∞—Ä—Å–∏—Ç XML-—Ñ–∞–π–ª `dictionary.xml`
2. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–∞—Ä—ã:
   - –ê–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ ‚Üí –†—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥
   - –†—É—Å—Å–∫–æ–µ —Å–ª–æ–≤–æ ‚Üí –ê–Ω–≥–ª–∏–π—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç —Å–ª–æ–≤–∞ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
- –£–¥–∞–ª—è–µ—Ç –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã (strip())
- –ö—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `_translation_dict`

---

>### `translate_word(word: str) -> str | None`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `word` - —Å–ª–æ–≤–æ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ (–∞–Ω–≥–ª–∏–π—Å–∫–æ–µ –∏–ª–∏ —Ä—É—Å—Å–∫–æ–µ)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- –ü–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞ –∏–ª–∏ `None`, –µ—Å–ª–∏ —Å–ª–æ–≤–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å–ª–æ–≤–∞—Ä–µ

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞ (–Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä + trim)
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±–æ–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö (EN‚ÜíRU –∏ RU‚ÜíEN)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
translation = translate_word("apple")  # –≤–µ—Ä–Ω–µ—Ç "—è–±–ª–æ–∫–æ"
translation = translate_word("—è–±–ª–æ–∫–æ")  # –≤–µ—Ä–Ω–µ—Ç "apple"
```

>### `is_in_dictionary(word: str) -> bool`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–ª–æ–≤–∞ –≤ —Å–ª–æ–≤–∞—Ä–µ.**

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `word` - —Å–ª–æ–≤–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**

- True –µ—Å–ª–∏ —Å–ª–æ–≤–æ –µ—Å—Ç—å –≤ —Å–ª–æ–≤–∞—Ä–µ, False - –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞

- –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é —Å–ª–æ–≤–∞—Ä—è

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
exists = is_in_dictionary("hello")  # –≤–µ—Ä–Ω–µ—Ç True
exists = is_in_dictionary("unknown")  # –≤–µ—Ä–Ω–µ—Ç False
```
**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
```python

XML_FILE = os.path.join(os.path.dirname(__file__), 'dictionary.xml')
```
- –£–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Ç—å –∫ XML-—Ñ–∞–π–ª—É —Å–æ —Å–ª–æ–≤–∞—Ä–µ–º

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –º–æ–¥—É–ª—è

**–§–æ—Ä–º–∞—Ç —Å–ª–æ–≤–∞—Ä—è**

- XML-—Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
xml
```XML
<dictionary>
  <entry>
    <en>–∞–Ω–≥–ª–∏–π—Å–∫–æ–µ —Å–ª–æ–≤–æ</en>
    <ru>—Ä—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</ru>
  </entry>
  ...
</dictionary>
```
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç XML-—Å–ª–æ–≤–∞—Ä—å (dictionary.xml)

- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

- –î–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–∞:

    - `translate_word()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞

    - `is_in_dictionary()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–ª–æ–≤–∞

**–§–æ—Ä–º–∞—Ç —Å–ª–æ–≤–∞—Ä—è:**

```xml

<dictionary>
  <entry>
    <en>apple</en>
    <ru>—è–±–ª–æ–∫–æ</ru>
  </entry>
  ...
</dictionary>
```
**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:

    - –°–ª–æ–≤–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª—è

    - –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π

- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:

    - –í—Å–µ —Å–ª–æ–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É

    - –£–¥–∞–ª—è—é—Ç—Å—è –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã

- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

    - –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–≤–æ–¥–∞–º —á–µ—Ä–µ–∑ —Ö—ç—à-—Ç–∞–±–ª–∏—Ü—É

    - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö

- –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:

    - –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

    - –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ—Ñ–ª–∞–π–Ω

    - –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

___
___

># –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
___
___

- `.env` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```ini

BOT_TOKEN="your_telegram_bot_token" # –ü–æ–ª—É—á–µ–Ω–Ω—ã–π API –æ—Ç BotFasther
DB_NAME="english_trainer" # –ù–∞–∑–≤–∞–Ω–∏–µ –ë–î
DB_USER="postgres" # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î
DB_PASSWORD="your_password" # –ü–∞—Ä–æ–ª—å –ë–î
DB_HOST="localhost" # –ê–¥—Ä–µ—Å—Å –ë–î
DB_PORT="5432" # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–ª–∏ –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä—Ç –ë–î
```
- `config.py` - –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

- `requirements.txt` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```text

python-dotenv>=1.0.0
aiogram>=3.0.0
sqlalchemy
asyncpg>=0.27.0
lxml>=4.9.3
pytz
datatime
typing
logging
```


___
___
> # –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞:
___
___

 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
    pip install -r requirements.txt
 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL:
    - –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –∏–º–µ–Ω–µ–º, —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ .env (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "english_trainer").
    - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ .env (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "postgres"/"postgres").
 3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env —Ñ–∞–π–ª:
4. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:
    python bot.py
 5. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
    - –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç default_words —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏).
    - –ï—Å–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞.
>## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞:
   - –ö–æ–º–∞–Ω–¥–∞ /start: –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—ã–≤–æ–¥ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é.
   - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é: –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤, –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ, —É–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ, –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å–ª–æ–≤–æ, –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç, –∏—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–æ–π `/history` `/last_test`).
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Å–ª–æ–≤–æ –∏ –ø–µ—Ä–µ–≤–æ–¥ —á–µ—Ä–µ–∑ —Ç–∏—Ä–µ.
   - –£–¥–∞–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª–æ–≤–æ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–≤–æ–∏—Ö —Å–ª–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.
   - –ü–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Å–ª–æ–≤–æ, –±–æ—Ç –∏—â–µ—Ç –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–ª–æ–≤–∞—Ä–µ (XML) –∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å.
   - –¢–µ—Å—Ç: –±–æ—Ç –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã (–ø–µ—Ä–µ–≤–æ–¥ —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç). –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –æ—Ç–≤–µ—Ç. –ü–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ —Ç–µ—Å—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.
   - –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤: –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ—à–ª—ã—Ö —Ç–µ—Å—Ç–æ–≤.
 –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ aiogram –≤–µ—Ä—Å–∏–∏ 3.x.
   - –°–æ—Å—Ç–æ—è–Ω–∏—è (FSM) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞–º–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–≤–æ–¥, —Ç–µ—Å—Ç).
   - –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è asyncpg (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø).
   - –ü–µ—Ä–µ–≤–æ–¥—á–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç XML-—Ñ–∞–π–ª (dictionary.xml) –∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–ª–æ–≤–∞).
 –û—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è:
   - –í –∫–æ–¥–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ.
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: 
   - –í learning_test.py –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å–ª–æ–≤–∞—Ä—å –∏–∑ dictionary.xml, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.
   - –í translator.py —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è dictionary.xml.
 –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã —Ñ–∞–π–ª dictionary.xml –±—ã–ª –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (–∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ).
 
 –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã dictionary.xml:
```XML
   <?xml version="1.0" encoding="UTF-8"?>
   <dictionary>
     <entry><en>word</en><ru>–ø–µ—Ä–µ–≤–æ–¥</ru></entry>
     ...
   </dictionary>
```
 –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: 
   - –í –∫–æ–¥–µ –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–µ—á–∞—Ç–æ–∫ (—Å–ª–æ–≤–∞—Ä—å ALLOWED_TYPOS –≤ learning_test.py).
